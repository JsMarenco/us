---
// Third-party dependencies
import type { User } from "@prisma/client";

// Current project dependencies
import timeAgo from "../../../utils/timeAgo";
import ShareButton from "./ShareButton";
import { defaultAvatar } from "../../../constants";

type Props = {
  writtenAt: string;
  creator: User;
  views?: number;
};

const { writtenAt, creator } = Astro.props;
const currentUrl = Astro.url;
---

<div
  class="mt-4 flex flex-col gap-4 border-t border-gray-300 pt-4 text-sm text-gray-600 dark:border-gray-600 dark:text-gray-400"
>
  <div class="flex items-center justify-between">
    <span class="flex items-center gap-2">
      <span class="font-medium text-gray-700 dark:text-gray-300"> Por: </span>

      <a
        class="flex items-center gap-2 rounded-lg bg-gray-100/50 px-3 py-1 transition hover:bg-gray-200/70 dark:bg-gray-800/50 dark:hover:bg-gray-700/60"
        href={`/u/${creator.username}`}
      >
        <img
          alt={creator.username}
          class="h-6 w-6 rounded-full border border-white dark:border-gray-600"
          src={defaultAvatar(creator.avatarSrc, creator.username)}
        />
        <span class="font-medium text-gray-900 dark:text-gray-100">
          {
            creator.firstName || creator.lastName
              ? `${creator.firstName ?? ""} ${creator.lastName ?? ""}`.trim()
              : creator.username
          }
        </span>
      </a>
    </span>

    <ShareButton client:load url={String(currentUrl)}>
      Copiar enlace
    </ShareButton>

    <span class="flex items-center gap-2">
      <span class="font-medium text-gray-700 dark:text-gray-300">
        Publicado:
      </span>
      <strong class="text-gray-900 dark:text-gray-100">
        {writtenAt ? `${timeAgo(writtenAt)}` : "Fecha desconocida"}
      </strong>
    </span>
  </div>

  <div
    class="mt-4 flex justify-center text-sm text-gray-600 dark:text-gray-400"
  >
    <span>
      Ver perfil de:
      <a
        class="ml-1 font-medium text-gray-900 underline transition hover:text-gray-700 dark:text-gray-100 dark:hover:text-gray-200"
        href={`/u/${creator.username}`}
      >
        {
          creator.firstName || creator.lastName
            ? `${creator.firstName ?? ""} ${creator.lastName ?? ""}`.trim()
            : creator.username
        }
      </a>
    </span>
  </div>
</div>
